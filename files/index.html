<!DOCTYPE html>
<!-- This code is for demonstration purposes only.  You should not hotlink to Github, Rawgit, or files from the Cytoscape.js documentation in your production apps. -->
<html>
<head>
  <style>
    body { 
      font: 14px helvetica neue, helvetica, arial, sans-serif;
    } 

    #cy {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  </style>
<meta charset=utf-8 />

<!-- For loading external data files -->
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise,fetch"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.15.1/cytoscape.min.js"></script>
<title>GraphData Demo</title>
</head>
<body>
<div id="cy"></div>
<!-- Load application code at the end to ensure DOM is loaded -->
<script>
  async function postData(url = '', data = {}) {
    // Default options are marked with *
    const response = await fetch(url, {
      method: 'POST', // *GET, POST, PUT, DELETE, etc.
      mode: 'same-origin', // no-cors, *cors, same-origin
      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
      credentials: 'same-origin', // include, *same-origin, omit
      headers: {
        'Content-Type': 'application/json'
        // 'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: JSON.stringify(data) // body data type must match "Content-Type" header
    });
    return response.json(); // parses JSON response into native JavaScript objects
  }

  var cy = window.cy = cytoscape({
    // these options hide parts of the graph during interaction
    //hideEdgesOnViewport: true,
    //hideLabelsOnViewport: true,

    // this is an alternative that uses a bitmap during interaction
    // textureOnViewport: true,

    // interpolate on high density displays instead of increasing resolution
    // pixelRatio: 1,

    // a motion blur effect that increases perceived performance for little or no cost
    // motionBlur: true,

    container: document.getElementById('cy'),

    style: cytoscape.stylesheet()
      .selector('node')
        .css({
          'width': 'mapData(weight, 0, 100, 10, 60)',
          'height': 'mapData(weight, 0, 100, 10, 60)'
        })
      .selector('edge')
        .css({
          'opacity': '0.333',
          'width': 'mapData(weight, 0, 100, 1, 6)',
          'curve-style': 'haystack' // fast edges!
        }),

    layout: {
      name: 'concentric',
      concentric: function( ele ){ return ele.data('weight'); },
      levelWidth: function( nodes ){ return 10; },
      padding: 10
    },

    elements: [{"data": {"id": "99999","weight": 85},"group": "nodes"}]
  });
  cy.on('click', function(evt){
    console.log( 'click ' + evt.target.id() );
    postData('/graph', { "vx": parseInt(evt.target.id()),"thr":123 })
      .then(data => {
        console.log(data); // JSON data parsed by `data.json()` call
      });
  });
</script>
</body>
</html>
